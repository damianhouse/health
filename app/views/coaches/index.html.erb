<p id="notice"><%= notice %></p>

<h1>Coaches Dashboard</h1>
<div class="panel panel-info">
  <div class="panel-heading">
    <h3 class="panel-title">Welcome <%= @coach.name %></h3>
  </div>
  <div class="panel-body">
    Conversations with users are below!
  </div>
</div>





<!--
<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>id</th>
      <th>Name</th>
      <th>Email</th>
      <th>Role</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
      <tr>
        <td><%= @coach.id %></td>
        <td><%= @coach.name %></td>
        <td><%= @coach.email %></td>
        <td><%= @coach.role %></td>
        <td><%= link_to 'Show', @coach %></td>
        <td><%= link_to 'Edit', edit_coach_path(@coach) %></td>
        <td><%= link_to 'Destroy', @coach, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
  </tbody>
</table> -->

<br><br><br>

<table class="table table-striped table-hover">
  <!-- <thead>
    <tr>
      <th>Conversation</th>
      <th>Name</th>
      <th>Email</th> -->
      <!-- <th>Role</th> -->
      <!-- <th>Coach</th> -->
      <!-- <th>Coach 1</th>
      <th>Coach 2</th>
      <th>Coach 3</th>
      <th>Coach 4</th> -->
      <!-- <th colspan="3"></th>
    </tr>
  </thead> -->

  <tbody>
    <% @coach.users.each do |user| %>
      <tr>
        <% user.conversations.each do |convo| %>
          <% if convo.coach_id == @coach.id %>
            <% if convo.messages.last.read == false && convo.messages.last.user_id != nil%>
              <td>UNREAD</td>
            <% else %>
            <td>READ </td>
            <% end %>
            <td><%= user.name %></td>
            <td><%= link_to 'View', convo %></td>
            <td><%= convo.messages.last.body %> </td>
            <td><%= convo.messages.last.created_at.to_formatted_s(:short)  %> </td>
          <% end %>
        <% end %>
        <td><%= user.email %></td>
        <!-- <td><%= user.role %></td> -->
        <!-- <td><%= user.coach_id %></td> -->
        <!-- <td><%= user.coach_1 %></td>
        <td><%= user.coach_2 %></td>
        <td><%= user.coach_3 %></td>
        <td><%= user.coach_4 %></td> -->
        <!-- <td><%= link_to 'Edit', edit_user_path(user) %></td> -->
        <!-- <td><%= link_to 'Destroy', user, method: :delete, data: { confirm: 'Are you sure?' } %></td> -->


      </tr>
    <% end %>
  </tbody>
</table>
